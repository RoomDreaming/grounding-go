build:
  gpu: true
  cuda: "11.8"
  python_version: "3.10"
  system_packages:
    - "libgl1-mesa-glx"
    - "libglib2.0-0"
  python_packages:
    - "opencv-python"
    - "pycocotools"
    - "matplotlib"
    - "onnxruntime"
    - "onnx"
    - "scipy"
    - "numpy"
    - "torch==2.0.1"
    - "torchvision==0.15.2"
    - "transformers"
    - "addict"
    - "yapf"
    - "timm"
    - "supervision"

  run:
    # 安裝 Segment Anything
    - pip install git+https://github.com/facebookresearch/segment-anything.git
    
    # 安裝 GroundingDINO
    - pip install git+https://github.com/IDEA-Research/GroundingDINO.git
    
    # 建立權重目錄
    - mkdir -p weights
    
    # 下載 GroundingDINO Config (Swin-T)
    - wget -O weights/GroundingDINO_SwinT_OGC.py https://raw.githubusercontent.com/IDEA-Research/GroundingDINO/main/groundingdino/config/GroundingDINO_SwinT_OGC.py
    
    # 下載 GroundingDINO 權重
    - wget -O weights/groundingdino_swint_ogc.pth https://github.com/IDEA-Research/GroundingDINO/releases/download/v0.1.0-alpha/groundingdino_swint_ogc.pth
    
    # 下載 SAM 權重 (ViT-H)
    - wget -O weights/sam_vit_h_4b8939.pth https://dl.fbaipublicfiles.com/segment_anything/sam_vit_h_4b8939.pth

predict: "predict.py:Predictor"
